release.txt


                           MODFLOW-NWT Release Notes


This file describes changes introduced into MODFLOW-NWT with each official
release; these changes may substantially affect users.


NOTE: Any use of trade, product or firm names is for descriptive purposes
only and does not imply endorsement by the U.S. Government.


o Version 1.0 05/11/2011:

This version is the initial release. However, a number of changes were required  
for four additional MODFLOW-2005 Packages that were not explained in the 
MODFLOW-NWT documentation report (Niswonger and others, 2011). The modified 
packages include the Horizontal-Flow Barrier, Lake, and Multi-Node Well Packages
versions 1 and 2.

Changes to the Horizontal-Flow (HFB) Barrier Package were made to the subroutine
GWF2HFB7FM. If the Newton method is used in MODFLOW-NWT, then horizontal
conductances do not include the aquifer thickness for unconfined conditions.
Thus, equations were changed such that the conductances modified in subroutine
GWF2HFB7FM are not multiplied by the aquifer thickness. This change required that
a new argument be added to the call statement for subroutine GWF2HFB7FM to include
the file unit number for the UPW Package.

Changes to the Lake (LAK) Package were made to the subroutine GWF2LAK7RP and a new 
subroutine was added to the LAK Package called SGWF2LAK7UPW1RPS for calculating
lakebed conductance values. This change required that a new argument be added to
the call statement for subroutine GWF2LAK7RP to include the file unit number for
the UPW Package.

Changes to Versions 1 and 2 of the multi-Node Well (MNW1 and MNW2) Packages were
made to the subroutines GWF2MNW17RP and GWF2MNW27RP. A new subroutine was added to
the MNW1 and MNW2 Packages called CEL2WELUPW for calculating well conductance
values. A new argument was added to the call statement for subroutines GWF2MNW17RP
and GWF2MNW27RP to include the file unit number for the UPW Package.

o Version 1.0.1 05/27/2011:

Changes were made to the MODFLOW-NWT source files to correct an error in how the
Horizontal-Flow (HFB) Barrier Package was implemented in MODFLOW-NWT. Additionally,
changes were made to deallocate arrays in the XMD and GMRES solvers at the termination 
of a simulation.

Source files that were modified include: MF_NWT.f, NWT1_solver.f, NWT1_xmd.f,     
gwf2hfb7_NWT.f, NWT1_gmres.f90, and gwf2bas7.f

o Version 1.0.2 10/03/2011:

MODFLOW-NWT was compiled again because the last release of the program required 
a large amount of RAM to run models. The reason for this unecessary memory usage
was not determined but it is assumed that the issue was related to the compiler.
The new compiled version requires much less memory. For example, a model that
required 2 Gb of memory to run now requires 120 Mb. This new memory usage
is consistent with what is required by MODFLOW-2005.

Changes were made to the MODFLOW-NWT source files such that residual-control 
(backtracking) iterations are no longer counted as outer iterations. This change 
affects the NWT solver iteration information that is printed to the main List file. 

Another change was made to stop model execution when the convergence criteria are not met.
In previous versions of MODFLOW-NWT, the model continued to solve after the model
failed to converge. A keyword option was added to the NWT Package input file to 
allow the user to control whether the model will stop after convergence failure. 
If the keyword "CONTINUE" is added following the input variable OPTIONS then the model  
will not stop after convergence failure. If this keyword is not specified then the 
model will stop after convergence failure. For example, the key word "CONTINUE" can 
be added to the first line of the NWT input file as:

1.0E-4 1. 500 1.0e-5  2  1 1 SPECIFIED CONTINUE 0.9 0.00001 0.000  0.10 0  20 2.0 0.6

For this input option, if the model fails to converge during a time step then it 
will continue to the next time step. However, if the "CONTINUE" is removed
from this line, then the model will stop after convergence failure.

Another change was made to fix a bug that caused the model to print a blank line
to the main List file rather than correctly printing the string "SPECIFIC YIELD
FOR LAYER..." This change does not affect model results.

Another change was made to modify how groundwater heads are reset to the layer-
bottom altitude when the calculated heads are below the bottom of the deepest layer. 
In the previous version of the code there was a condition when heads could be 
reset to an incorrect value, and this caused small oscillations in some problems.   
This change may have a small affect to improve model convergence if the NWT input 
variable IBOTAV is equal to 1.

Another change was made to fix oscillatory behavior caused by a feature in the MNW2
and MNW1 packages. The original versions of these packages switched between
a specified flux and a head-dependent boundary conditions during outer iterations.
The MNW1 and MNW2 packages were modified such that the boundary condition is
fixed as a head-dependent boundary condition.

A small change was made in the XMD source file to allow for double precision
compilations. This change was to change the statement from real*4 to real. 

Small changes were made to the UZF1 and SFR2 source files to improve standard
output options.

Changes were made to the MT3DMS linker files (lmt7_NWT.f, and lmt7_NWT.inc) to
include water balance information for the MNW2 and MNW1 packages.

Source files that were modified include: MF_NWT.f, NWT1_solver.f, NWT1_xmd.f,     
gwf2MNW27_NWT.f, gwf2MNW17_NWT.f, gwf2sfr7_NWT.f, gwf2upw1.f, gwfsfrmodule_NWT.f, 
gwf2uzf1_NWT.f, gwfuzfmodule_NWT.f, lmt7_NWT.f, and lmt7_NWT.inc.

Reference:

Niswonger, R.G., Panday, Sorab, and Ibaraki, Motomu, 2011, MODFLOW-NWT, 
A Newton formulation for MODFLOW-2005: U.S. Geological Survey Techniques 
and Methods 6–A37, 44 p.



